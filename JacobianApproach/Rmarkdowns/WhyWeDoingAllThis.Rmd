---
title: "Why we doing all this?"
author: "Nico, Jeff & NÃºria"
date: "2026-01-16"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Overview

This document explains the project from first principles: the motivation, the mathematical objects, the interpretation in frequency and time domains, the definition of structural sensitivity, the role of cutoffs, and how the computational pipeline implements the concepts.

# 1. Motivation

We study the stability of ecological communities near an equilibrium. A linearized model can be asymptotically stable and still exhibit strong transient responses, mid-time amplification, or high sensitivity to small changes in interaction structure. The central scientific question is:

How and when does network structure (who interacts with whom) generate meaningful differences in stability that cannot be reduced to species time-scales alone or to asymptotic resilience?

A second, equally important objective is to separate two ideas that are often conflated:

1. Structural sensitivity: stability changes because the interaction structure changes.

2. Information or noise sensitivity: stability changes because the forcing or uncertainty model changes (for example, how noise enters the system).

To address these questions, we require a framework that is interpretable, formal, and comparable across many communities.

# 2. Conceptual pivot: from pulse perturbations to stochastic variability

A common approach is to study pulse perturbations: apply a small displacement \(x_0\) and examine the trajectory \(x(t)=e^{tJ}x_0\). This is informative but introduces ambiguity about which time windows are intrinsically comparable across systems.

We instead pivot to a stability concept with a direct stochastic meaning: temporal variability under persistent random forcing. The key idea is that integrated squared responses can be interpreted as variance generated by stochastic noise. This provides a canonical, well-established stability quantity.

# 3. Model with time-scales and noise

We consider a linearized community model with heterogeneous time-scales and additive white noise:
$$
T\,\dot{x}(t) = \bar{A}\,x(t) + \xi(t)
$$
where:

- \(x(t)\in\mathbb{R}^S\) is the deviation from equilibrium.

- \(T\) is diagonal and encodes species time-scales.

- \(\bar{A}\) is the effective interaction matrix including self-regulation (often \(\bar{A}=-I+A\)).

- \(\xi(t)\) is a white-noise forcing term with covariance
  $$
  \mathbb{E}[\xi(t)\,\xi(t')^\top] = C_0\,\delta(t-t')
  $$

Intuition: the ecosystem is continuously perturbed by small random fluctuations. Stability is measured by how strongly these fluctuations are amplified into state variability.

# 4. Frequency-domain representation and the resolvent

Taking Fourier transforms yields the frequency response
$$
\hat{x}(\omega) = R(\omega)\,\hat{\xi}(\omega), \qquad
R(\omega) = \bigl(i\,\omega\,T - \bar{A}\bigr)^{-1}
$$

The resolvent \(R(\omega)\) is the central object: it describes the system as a multivariate filter mapping forcing at frequency \(\omega\) to state fluctuations at the same frequency.

## 4.1 Spectral covariance and energy density

Define the spectral covariance of the state as
$$
\hat{C}(\omega) = R(\omega)\,C_0\,R(\omega)^\dagger
$$

A natural normalized energy density is
$$
e(\omega) = \frac{\mathrm{tr}\bigl(\hat{C}(\omega)\bigr)}{\mathrm{tr}(C_0)}
= \frac{\mathrm{tr}\bigl(R(\omega)\,C_0\,R(\omega)^\dagger\bigr)}{\mathrm{tr}(C_0)}
$$

Interpretation: \(e(\omega)\) tells us where the variability lives across frequencies. Large values of \(e(\omega)\) indicate frequencies that contribute strongly to the system's fluctuations.

## 4.2 Total variability

The total normalized variability is the spectral integral
$$
V = \frac{1}{2\pi}\int e(\omega)\,d\omega
$$

High \(V\) means stronger amplification of noise into fluctuations, i.e. lower stability in the variability sense.

# 5. Time-domain equivalence via Lyapunov

The same variability can be computed exactly in the time domain. Writing the system in standard form,
$$
\dot{x}(t) = J\,x(t) + \eta(t)
$$
with
$$
J = \mathrm{diag}(u)\,\bar{A}, \qquad \eta(t) = \mathrm{diag}(u)\,\xi(t)
$$
the noise covariance becomes
$$
Q = \mathbb{E}[\eta(t)\,\eta(t)^\top] = \mathrm{diag}(u)\,C_0\,\mathrm{diag}(u)
$$

The stationary covariance \(\Sigma\) solves the continuous Lyapunov equation
$$
J\,\Sigma + \Sigma\,J^\top + Q = 0
$$

A matching normalized variability is
$$
V = \frac{\mathrm{tr}(\Sigma)}{\mathrm{tr}(C_0)}
$$

The frequency integral and the Lyapunov solution provide two equivalent ways to compute \(V\). Agreement between them is a key validation check for the implementation.

# 6. Structural sensitivity and structural fragility

The central new quantity is structural fragility: how strongly variability changes under small changes in interaction structure.

We perturb the structure as
$$
\bar{A} \to \bar{A} + \varepsilon P
$$
where \(P\) represents a direction of structural uncertainty (e.g. rewiring or interaction perturbations), typically constrained so that \(\|P\|_F=1\) and the diagonal of \(P\) is excluded.

We want a formal first-order description of how (V) changes.

## 6.1 Frequency-local fractional sensitivity

The meeting notes highlight a key frequency-local term. Define
$$
g(\omega;P) \approx
\frac{2\,\mathrm{Re}\,\mathrm{tr}\bigl(R(\omega)\,P\,\hat{C}(\omega)\bigr)}
{\mathrm{tr}\bigl(\hat{C}(\omega)\bigr)},
\qquad \hat{C}(\omega)=R(\omega)\,C_0\,R(\omega)^\dagger
$$

Interpretation:

- \(g(\omega;P)\) measures the fractional sensitivity of the spectrum at frequency \(\omega\) to a structural perturbation in direction (P).

- The magnitude \(|g(\omega;P)|\) quantifies structural leverage at that frequency.

## 6.2 From local sensitivity to total fragility

Because \(V\) is an integral over \(e(\omega)\), the first-order fractional change of \(V\) is approximately a weighted average of \(g(\omega;P)\) with weights given by \(e(\omega)\):
$$
\frac{\Delta V}{V} \approx
\varepsilon\,\left|
\frac{\int g(\omega;P)\,e(\omega)\,d\omega}{\int e(\omega)\,d\omega}
\right|
$$

This is the central conceptual link:

- Frequencies with negligible \(e(\omega)\) contribute little to total variability and therefore little to total fragility, even if sensitivity is large.

- Frequencies with negligible \(g(\omega;P)\) are structurally irrelevant, even if variability is large.

Structural fragility lives where energy and leverage overlap across frequency.

# 7. Structural sensitivity versus information or noise sensitivity

The framework distinguishes two separable mechanisms that can change variability:

1. Structural sensitivity changes \(R(\omega)\) by changing \(\bar{A}\).

2. Information or noise sensitivity changes the forcing model, primarily \(C_0\) (and possibly the time-scale model \(T\)).

Both influence \(\hat{C}(\omega)=R(\omega)C_0R(\omega)^\dagger\), but they represent different scientific statements. A community can be stable or unstable in variability because of how noise enters, even if it is robust to structural perturbations, and vice versa.

# 8. Cutoffs and windows in frequency

Several frequency scales appear and they answer different questions. It is essential not to conflate them.

## 8.1 Energetic window \([\omega_L,\omega_H]\)

Define \(\omega_L\) and \(\omega_H\) as quantiles of the cumulative spectral mass:
$$
\int_0^{\omega_L} e(\omega)\,d\omega = q_L\int_0^{\infty} e(\omega)\,d\omega \ ;
\qquad
\int_0^{\omega_H} e(\omega)\,d\omega = q_H\int_0^{\infty} e(\omega)\,d\omega
$$

Interpretation: \([\omega_L,\omega_H]\) contains a chosen fraction (for example 90 percent) of the total variability. This is a principled way to exclude extremely low or high frequencies when focusing on the frequencies that dominate \(V\).

## 8.2 Bandwidth cutoff \(\omega_c\) (half-power of \(e(\omega)\))

A bandwidth cutoff is a level-set definition, for example
$$
e(\omega_c) = \tfrac{1}{2}\,e(0)
$$

Interpretation: \(\omega_c\) is a knee or characteristic roll-off frequency of the spectrum. It is not a statement that frequencies above \(\omega_c\) are irrelevant, because \(e(\omega)\) is a density and relevance depends on the remaining tail area.

## 8.3 Structural relevance cutoffs

If the question is specifically when structure stops mattering, a natural approach is to define a cumulative cutoff on the structural contribution integrand, for example
$$
m(\omega)=\mathbb{E}*P\bigl[|g(\omega;P)|\bigr],e(\omega)
$$
and then define \(\omega_{S,95}\) by a 95 percent cumulative mass criterion on \(m(\omega)\). This directly supports statements about where most of the potential structural effect resides.

# 9. Direct versus indirect effects and frequency-dependent interactions

A useful conceptual decomposition is to separate self-filtering from network feedback. Define the diagonal filter
$$
D(\omega) = \bigl(I + i\,\omega\,T\bigr)^{-1}
$$
and an effective frequency-dependent interaction matrix
$$
A_\omega = A\,D(\omega)
$$
where \(A\) denotes the interaction component separated from self-regulation under a chosen convention.

Interpretation:

- \(D(\omega)\) captures the low-pass behavior induced by time-scales.

- The factor involving \(A_\omega\) captures propagation through the interaction network. Indirect pathways and feedback can accumulate when the effective interaction is strong in the relevant frequency range.

To probe different mechanisms, one can evaluate proxies such as \(\rho(A_\omega)\) (related to pathway accumulation and feedback) and \(\|A_\omega\|_2\) (related to direct strength and amplification capacity). Importantly, strong sensitivity can arise even when feedback is weak, for example through non-normal feed-forward structure, so collectivity is not the only route to fragility.

